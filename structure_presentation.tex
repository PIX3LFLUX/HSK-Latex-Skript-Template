\usepackage[utf8]{inputenc}
\usepackage{hyperref}

% Change the presentation layout
\geometry{papersize={33.867cm,19.05cm}}

\usepackage{tikz}
\usetikzlibrary{external}
\usetikzlibrary{positioning}
\usetikzlibrary{calc}

\usepackage{xsavebox} %save content for repeated use
\usepackage{atbegshi} %insert material on every page
\usepackage[absolute,overlay]{textpos}
\usepackage{anyfontsize}

% \usepackage{fontspec}
% \setmainfont{Calibri}

% \setsansfont{Carlito}[
%  Path=./Carlito/,
%  Extension = .ttf,
%  UprightFont = *-Regular,
%  BoldFont = *-Bold,
%  ItalicFont = *-Italic,
%  BoldItalicFont = *-BoldItalic]

% ALternative solution if could not use `fontspec`
\usepackage[sfdefault,lf]{carlito}
% \usepackage[default]{opensans}

\usepackage[T1]{fontenc}
\renewcommand*\oldstylenums[1]{\carlitoOsF #1}

\usepackage[backend=biber, style=ieee]{biblatex}
\usepackage{verbatim}
\usepackage{ragged2e}

\usepackage{calc}
\usepackage{xparse,siunitx}

\usepackage{color, colortbl}
\usepackage{lipsum}
\usepackage{graphicx,trimclip}
\usepackage{setspace}

\usepackage[ngerman]{babel}
\usepackage[]{datetime}
\newdateformat{usvardate}{%
	\monthname[\THEMONTH] \THEYEAR}

\usepackage{booktabs,siunitx,array,threeparttable}

\newcommand*\MeasuredFigureLabel[1]{
	\addtocounter{figure}{-1}
	\phantomcaption
	\label{#1}
}

% \pgfdeclarelayer{background}
% \pgfdeclarelayer{foreground}
% \pgfsetlayers{background,main,foreground}

\newcolumntype{x}[1]{>{\centering\arraybackslash\hspace{0pt}}p{#1}}

%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%% Beamer template
\setbeamertemplate{itemize items}[circle]
\setbeamertemplate{itemize subitem}[circle]
\setbeamertemplate{itemize subsubitem}[circle]

\setbeamertemplate{enumerate items}[default]
\setbeamertemplate{caption}[numbered]

\setbeamertemplate{background}
{
	\includegraphics[width=\paperwidth,height=\paperheight,keepaspectratio]{Templates/HKA-Normal.pdf}
}


\setbeamercolor{section in toc}{fg=black}
\setbeamerfont{section in toc}{size=\large}

% \setbeamertemplate{section in toc}{\inserttocsection}
% \setbeamertemplate{section in toc}[default]
% \setbeamertemplate{section in toc}[ball unnumbered]
% \setbeamertemplate{section in toc}[square]
% \setbeamertemplate{section in toc}{\inserttocsectionnumber.~\inserttocsection}
% \setbeamertemplate{section in toc}[ball]

\defbeamertemplate{section in toc}{sectionasitem}{%
	\leavevmode%
	\usebeamerfont*{itemize item}%
	\raise1.25pt\hbox{\small$\bullet$}
	{\usebeamercolor*[fg]{normal text}\quad\inserttocsection}%
}
\setbeamertemplate{section in toc}[sectionasitem]

\setbeamercolor{alerted text}{fg=ThemeColor}

\setbeamertemplate{itemize item}{\raise1.25pt\hbox{\color{black}\small$\bullet$}}
\setbeamertemplate{itemize subitem}{\color{black}\small$\blacktriangleright$}

\setbeamersize{text margin left=0cm,text margin right=0cm}

\settowidth{\leftmargini}{\usebeamertemplate{itemize item}}
\addtolength{\leftmargini}{1.2\labelsep}

% Set color in reference
\DeclareNameWrapperFormat{coloursortname}{\textcolor{black}{#1}}
\DeclareFieldFormat{colourparens}{\textcolor{black}{\mkbibparens{#1}}}
\setbeamercolor{bibliography entry author}{fg=black}
\setbeamercolor{bibliography entry title}{fg=black}
\setbeamercolor{bibliography entry location}{fg=black}
\setbeamercolor{bibliography entry note}{fg=black}

% \usepackage{adjustbox}

% \defbeamertemplate*{navigation symbols}{enlarged}
% {%
%     \adjustbox{min width=0.4\paperwidth}{%
%         \hbox{%
%             \hbox{\insertslidenavigationsymbol}
%             \hbox{\insertframenavigationsymbol}
%             \hbox{\insertsubsectionnavigationsymbol}
%             \hbox{\insertsectionnavigationsymbol}
%             \hbox{\insertdocnavigationsymbol}
%             \hbox{\insertbackfindforwardnavigationsymbol}%
%         }%
%     }
% }


% List
% \let\OLDitemize\itemize
% \renewcommand\itemize{\OLDitemize\addtolength{\itemsep}{20pt}}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% \ExplSyntaxOn
% \DeclareExpandableDocumentCommand{\convertdim}{O{2}mm}
%  {
%   \fp_eval:n { round ( \dim_to_decimal_in_unit:nn { #2 } { 1#3 } , #1 ) }
%  }
% \ExplSyntaxOff

% \NewDocumentCommand{\getlengthin}{O{2}mm}
%  {%
%   \SI[round-mode=places,round-precision=#1]{\convertdim{#2}{#3}}{#3}%
%  }


% \setsansfont{Carlito}[
%  Path=./Carlito/,
%  Extension = .ttf,
%  UprightFont = *-Regular,
%  BoldFont = *-Bold,
%  ItalicFont = *-Italic,
%  BoldItalicFont = *-BoldItalic]


\newcommand{\formatcontent}{\fontsize{\contenttextsize}{32}\selectfont}

\newcommand{\placetextbox}[4]{%
	% #1: horizontal position
	% #2: vertical position
	% #3: maximum width
	% #4: content
	%
	\begin{tikzpicture}[remember picture, overlay]
		\node[inner sep=0pt, text width=#3, anchor=north west] at ($(current page.north west) + (#1, #2)$)
		{
			#4
		};
	\end{tikzpicture}
}

\newcommand{\placepictureandtext}[7]{%
	% #1: horizontal position
	% #2: vertical position
	% #3: maximum width
	% #4: text horizontal position
	% #5: text vertical position
	% #6: picture content
	% #7: text content

	\begin{tikzpicture}[remember picture, overlay]
		\node[inner sep=0pt, text width=#3, anchor=north west] (picture) at ($(current page.north west) + (#1, #2)$)
		{
			#6
		};

		\node[below left = #5 and #4 of picture, inner sep=0pt,outer sep=0, anchor=north west] (c)
		{
			#7
		};
	\end{tikzpicture}
}

%% Cover page
\newcommand\picdims[4][]{%
	\setbox0=\hbox{\includegraphics[#1]{#4}}%
	\clipbox{.5\dimexpr\wd0-#2\relax{} %
		.5\dimexpr\ht0-#3\relax{} %
		.5\dimexpr\wd0-#2\relax{} %
		.5\dimexpr\ht0-#3\relax}{\includegraphics[#1]{#4}}}


\newcommand \EITCoverVI[3]{
	\begin{frame}

		\begin{tikzpicture}[remember picture, overlay]
			\node[at=(current page.center)]{\includegraphics[width=\paperwidth, height=\paperheight]{Templates/HKA-Opening.pdf}};

			\node[inner sep=0pt, text width=\paperwidth, anchor=south west] at ($(current page.center) + (-16cm, 2.6cm)$)
			{\fontsize{\covertextsize}{30}\selectfont\color{ThemeColor} #1};
		\end{tikzpicture}

		% Cover picture
		\begin{tikzpicture}[remember picture, overlay]
			\node[inner sep=0pt, anchor=north west] at ($(current page.west) + (0, 1.907cm)$)
			{
				\picdims[width=\paperwidth]{\paperwidth}{10.2cm}{#3}
			};

			\node[inner sep=0pt, text width=\paperwidth, anchor=south west] at ($(current page.center) + (-16cm, -9cm)$)
			{\fontsize{9.1}{5}\selectfont\color{ThemeColor} #2};
		\end{tikzpicture}

		\begin{tikzpicture}[remember picture, overlay]
			\node[at=(current page.center)]{\includegraphics[width=\paperwidth, height=\paperheight]{Templates/HKA_Opening_KA_text.pdf}};
		\end{tikzpicture}
	\end{frame}
}

\setbeamertemplate{frametitle}
{
	\begin{tikzpicture}[remember picture, overlay]
		\node[inner sep=0pt, text width=\paperwidth, anchor=north west] at ($(current page.north west) + (\leftmarginpos, \topmargintitle)$)
		{\fontsize{\titletextsize}{2}\selectfont\color{ThemeColor} \insertframetitle};
	\end{tikzpicture}
}

\newcommand \EITHeadline[2]{
	\begin{frame}
		% Cover title
		\frametitle{#1}

		{#2}

		\begin{tikzpicture}[remember picture, overlay]
			\node[inner sep=0pt,outer sep=0, text width=\paperwidth, anchor=north west](a) at ($(current page.center) + (-16cm, -7.55cm)$)
			{ \fontsize{10}{12}\selectfont\color{ThemeColor}
				Hochschule Karlsruhe
			};
			\node[below left = 0.2cm and 0cm of a, inner sep=0pt,outer sep=0, anchor=north west] (b)
			{
				\fontsize{10}{12}\selectfont\color{ThemeColor}
				\usvardate\today
			};
			\node[below left = 0.2cm and 0cm of b, inner sep=0pt,outer sep=0, anchor=north west] (c)
			{
				\fontsize{10}{12}\selectfont\color{ThemeColor}
				\insertframenumber
			};

		\end{tikzpicture}

		\begin{tikzpicture}[remember picture, overlay]
			\node[at=(current page.center)]{\includegraphics[width=\paperwidth, height=\paperheight]{Templates/HKA_Slide_KA_text.pdf}};
		\end{tikzpicture}
	\end{frame}
}

\newcommand \EITHeadlineFT[2]{
	\EITHeadline{#1}{
		\placetextbox{\leftmarginpos}{\topmargincontent}{\maximumwidth}{
			#2
		}
	}
}

\newcommand \EITTableOfContent[2]{
	\EITHeadlineFT{#1}{
		\begin{spacing}{#2}
			\tableofcontents
		\end{spacing}
	}
}


