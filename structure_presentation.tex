\usepackage[utf8]{inputenc}
\usepackage{hyperref}

% Change the presentation layout
\geometry{papersize={33.867cm,19.05cm}}

\usepackage{tikz}
\usetikzlibrary{external}
\usetikzlibrary{positioning}
\usetikzlibrary{calc}

\usepackage{xsavebox} %save content for repeated use
\usepackage{atbegshi} %insert material on every page
\usepackage[absolute,overlay]{textpos}
\usepackage{anyfontsize}

% \usepackage{fontspec}
% \setmainfont{Calibri}

% \setsansfont{Carlito}[
%  Path=./Carlito/,
%  Extension = .ttf,
%  UprightFont = *-Regular,
%  BoldFont = *-Bold,
%  ItalicFont = *-Italic,
%  BoldItalicFont = *-BoldItalic]

% ALternative solution if could not use `fontspec`
\usepackage[sfdefault]{carlito}
\newcolumntype{x}[1]{>{\centering\arraybackslash\hspace{0pt}}p{#1}}


\usepackage[backend=biber,]{biblatex}

% \usepackage{setspace}
% \linespread{2} 
\usepackage{verbatim}
\usepackage{ragged2e}

% \newcommand{\covertextsize}{44}
% \newcommand{\titletextsize}{32}
% \newcommand{\contenttextsize}{18}

\setbeamertemplate{itemize items}[circle]
\setbeamertemplate{itemize subitem}[circle]
\setbeamertemplate{itemize subsubitem}[circle]

\setbeamertemplate{enumerate items}[default]

\usepackage{calc}

\usepackage{xparse,siunitx}

\ExplSyntaxOn
\DeclareExpandableDocumentCommand{\convertdim}{O{2}mm}
 {
  \fp_eval:n { round ( \dim_to_decimal_in_unit:nn { #2 } { 1#3 } , #1 ) }
 }
\ExplSyntaxOff

\NewDocumentCommand{\getlengthin}{O{2}mm}
 {%
  \SI[round-mode=places,round-precision=#1]{\convertdim{#2}{#3}}{#3}%
 }


% \setsansfont{Carlito}[
%  Path=./Carlito/,
%  Extension = .ttf,
%  UprightFont = *-Regular,
%  BoldFont = *-Bold,
%  ItalicFont = *-Italic,
%  BoldItalicFont = *-BoldItalic]

\usepackage{color, colortbl}
\usepackage{lipsum}  


%% Cover page
\setbeamertemplate{background}
{
    \includegraphics[width=\paperwidth,height=\paperheight,keepaspectratio]{Templates/HKA-Normal.pdf}
}

\usepackage{graphicx,trimclip}
\newcommand\picdims[4][]{%
    \setbox0=\hbox{\includegraphics[#1]{#4}}%
    \clipbox{.5\dimexpr\wd0-#2\relax{} %
        .5\dimexpr\ht0-#3\relax{} %
        .5\dimexpr\wd0-#2\relax{} %
        .5\dimexpr\ht0-#3\relax}{\includegraphics[#1]{#4}}}


\newcommand \EITCoverVI[2]{
    \begin{frame}

        \begin{tikzpicture}[remember picture, overlay]
            \node[at=(current page.center)]{\includegraphics[width=\paperwidth, height=\paperheight]{Templates/HKA-Opening.pdf}};

            \node[inner sep=0pt, text width=\paperwidth, anchor=south west] at ($(current page.center) + (-16cm, 2.6cm)$)
            {\fontsize{\covertextsize}{30}\selectfont\color{ThemeColor} #1};
        \end{tikzpicture}

        % Cover picture
        \begin{tikzpicture}[remember picture, overlay]
            \node[inner sep=0pt, anchor=north west] at ($(current page.west) + (0, 2.1cm)$)
            {
                \picdims[width=\paperwidth]{\paperwidth}{10.2cm}{Pictures/csm_HKA_FK-EIT_2017-9363_a9e6e1d039.jpg}
            };

            \node[inner sep=0pt, text width=\paperwidth, anchor=south west] at ($(current page.center) + (-16cm, -9cm)$)
            {\fontsize{9.1}{5}\selectfont\color{ThemeColor} #2};
        \end{tikzpicture}

        \begin{tikzpicture}[remember picture, overlay]
            \node[at=(current page.center)]{\includegraphics[width=\paperwidth, height=\paperheight]{Templates/HKA_Opening_KA_text.pdf}};
        \end{tikzpicture}
    \end{frame}
}

% \setbeamertemplate{frametitle}
% {
%     \begin{tikzpicture}[remember picture, overlay]
%         \node[inner sep=0pt, text width=\paperwidth, anchor=north west] at ($(current page.center) + (-16cm, 8.7cm)$)
%         {\fontsize{\titletextsize}{2}\selectfont\color{ThemeColor} \insertframetitle};
%     \end{tikzpicture}
% }

\setbeamertemplate{frametitle}
{
    \begin{tikzpicture}[remember picture, overlay]
        \node[inner sep=0pt, text width=\paperwidth, anchor=north west] at ($(current page.north west) + (\leftmarginpos, \topmargintitle)$)
        {\fontsize{\titletextsize}{2}\selectfont\color{ThemeColor} \insertframetitle};
    \end{tikzpicture}
}

\usepackage[]{datetime}
\newdateformat{usvardate}{%
    \monthname[\THEMONTH] \THEYEAR}

% \setbeamersize{text margin left=0pt,text margin right=1.5cm}

\settowidth{\leftmargini}{\usebeamertemplate{itemize item}}
\addtolength{\leftmargini}{1.5\labelsep}

\newcommand \EITHeadline[2]{
    \begin{frame}
        % Cover title
        \frametitle{#1}

        {#2}

        \begin{tikzpicture}[remember picture, overlay]
            \node[inner sep=0pt, text width=\paperwidth, anchor=north west] at ($(current page.center) + (-16cm, -7.5cm)$)
            {\fontsize{10}{14}\selectfont\color{ThemeColor}
                Hochschule Karlsruhe \\
                \usvardate\today \\
                \insertframenumber
            };
        \end{tikzpicture}

        \begin{tikzpicture}[remember picture, overlay]
            \node[at=(current page.center)]{\includegraphics[width=\paperwidth, height=\paperheight]{Templates/HKA_Slide_KA_text.pdf}};
        \end{tikzpicture}
    \end{frame}

}
\newcommand \EITHeadlineFT[2]{
    \EITHeadline{#1}{
        \begin{textblock*}{\maximumwidth}(\leftmarginpos,\topmargincontent)
            {   \fontsize{\contenttextsize}{32}\selectfont 
                #2}
        \end{textblock*}    
    }
}

\newcommand \EITHeadlineFTTwoColumn[5]{
    \EITHeadline{#1}{
        \begin{textblock*}{\columnmaxwidth}(\leftmarginpos,\topmargincontent)
            {   \fontsize{\contenttextsize}{32}\selectfont 
                #4}
        \end{textblock*}

        \begin{textblock*}{\columnmaxwidth}(\secondcolumnstart,\topmargincontent)
            {   \fontsize{\contenttextsize}{32}\selectfont 
                #5}
        \end{textblock*}
    }
}

\setbeamercolor{section in toc}{fg=black}
\setbeamerfont{section in toc}{size=\huge}

% \setbeamertemplate{section in toc}{\inserttocsection}
% \setbeamertemplate{section in toc}[circle]
% \setbeamertemplate{section in toc}[ball unnumbered]
% \setbeamertemplate{section in toc}[square]
% \setbeamertemplate{section in toc}{\inserttocsectionnumber.~\inserttocsection}
\setbeamertemplate{section in toc}[ball]

\usepackage{setspace}

\newcommand \EITTableOfContent{
    \EITHeadlineFT{Table Of Contents}{
        \begin{spacing}{5}
            \tableofcontents 
        \end{spacing}
    }
}


\newcommand \EITOnePicture[2]{
    \EITHeadlineFT{#1}{
        \begin{tikzpicture}[remember picture, overlay]
            \node[inner sep=0pt, anchor=north west] at ($(current page.west) + (0, 2.1cm)$)
            {
                \picdims[width=\paperwidth]{\paperwidth}{10.2cm}{#2}
            };            
        \end{tikzpicture}
    }
}



%%
